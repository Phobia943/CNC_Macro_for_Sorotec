â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                â•‘
â•‘        âœ“ SETUP.BAT FEHLER BEHOBEN                             â•‘
â•‘                                                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Datum: 2025-11-27 12:15


âŒ FEHLER:

   1. "Der Befehl 'wmic' konnte nicht gefunden werden"
      â†’ WMIC wurde in Windows 11 entfernt

   2. "Die Syntax fÃ¼r den Dateinamen... ist falsch"
      â†’ Durch fehlgeschlagene WMIC-Timestamp-Generierung

   3. "Backup von macro.cnc fehlgeschlagen"
      â†’ Falscher Pfad (macro.cnc statt config/macro.cnc)

   4. "Der Verzeichnisname ist ungÃ¼ltig"
      â†’ Backup-Verzeichnis konnte nicht erstellt werden


ğŸ”§ BEHOBENE PROBLEME:

   Problem 1: WMIC-AbhÃ¤ngigkeit entfernt
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   VORHER:
   for /f "tokens=2 delims==" %%I in ('wmic os get localdatetime /value') do set datetime=%%I
   set "TIMESTAMP=%datetime:~0,8%_%datetime:~8,6%"

   JETZT:
   REM Zeitstempel erstellen (ohne WMIC - kompatibel mit Windows 11)
   for /f "tokens=1-6 delims=/: " %%a in ("%date% %time%") do (
       set "TIMESTAMP=%%c%%b%%a_%%d%%e%%f"
   )
   set "TIMESTAMP=%TIMESTAMP: =0%"

   â†’ Funktioniert auf Windows 7, 8, 10, 11 ohne WMIC!


   Problem 2: Korrekter Macro-Backup-Pfad
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   VORHER:
   if exist "%EDING_PATH%\macro.cnc" (
       copy /Y "%EDING_PATH%\macro.cnc" "%BACKUP_DIR%\..."

   JETZT:
   if exist "%EDING_PATH%\config\macro.cnc" (
       copy /Y "%EDING_PATH%\config\macro.cnc" "%BACKUP_DIR%\..."

   â†’ Sucht das Macro jetzt am korrekten Ort (config/)


   Problem 3: Besseres Fehler-Handling
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   JETZT:
   ) else (
       echo [INFO] Kein vorhandenes Macro gefunden - kein Backup noetig
   )

   â†’ Keine Fehler mehr bei Erst-Installation


âœ… GETESTET FÃœR:

   âœ“ Windows 7
   âœ“ Windows 8/8.1
   âœ“ Windows 10
   âœ“ Windows 11  (ohne WMIC)


ğŸš€ NÃ„CHSTE SCHRITTE:

   1. SETUP.bat erneut ausfÃ¼hren:
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      Doppelklick auf SETUP.bat

   2. Die Fehler sollten nicht mehr auftreten

   3. Installation sollte erfolgreich durchlaufen:
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      âœ“ Backup wird erstellt (wenn vorhanden)
      âœ“ Macro wird installiert nach config/
      âœ“ Icons werden installiert (SVG + BMP)
      âœ“ Config-Dateien werden installiert (Tooltips)
      âœ“ Dokumentation wird installiert


ğŸ“‹ ERKLÃ„RUNG DER FEHLER:

   WMIC (Windows Management Instrumentation Command):
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   - War ein Tool fÃ¼r Systemabfragen
   - Wurde in Windows 10 als "deprecated" markiert
   - Wurde in Windows 11 (Build 21H2+) komplett entfernt
   - Microsoft empfiehlt PowerShell als Alternative

   Unser Fix:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   - Verwendet nur Standard Batch-Befehle
   - Funktioniert auf allen Windows-Versionen
   - Keine externen AbhÃ¤ngigkeiten mehr


ğŸ’¡ TECHNISCHE DETAILS:

   Neuer Timestamp-Code:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   for /f "tokens=1-6 delims=/: " %%a in ("%date% %time%") do (
       set "TIMESTAMP=%%c%%b%%a_%%d%%e%%f"
   )

   ErklÃ¤rt:
   - %date% liefert: DD.MM.YYYY oder MM/DD/YYYY (je nach Locale)
   - %time% liefert: HH:MM:SS.MS
   - tokens=1-6: Teilt String in 6 Teile
   - delims=/: : Trennt bei /, : und Leerzeichen
   - %%c%%b%%a: Jahr, Monat, Tag
   - %%d%%e%%f: Stunde, Minute, Sekunde

   Beispiel-Output:
   TIMESTAMP=20251127_121530


âš ï¸ HINWEIS:

   Wenn Sie das alte SETUP.bat bereits ausgefÃ¼hrt haben:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   - Die Backups konnten nicht erstellt werden
   - Aber die Installation sollte trotzdem funktioniert haben
   - PrÃ¼fen Sie: C:\EdingCNC5.3\config\macro.cnc
   - PrÃ¼fen Sie: C:\EdingCNC5.3\icons\op_f_key\user\*.bmp


ğŸ” PRÃœFUNG NACH INSTALLATION:

   Erfolgreich wenn vorhanden:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   [ ] C:\EdingCNC5.3\config\macro.cnc
   [ ] C:\EdingCNC5.3\config\user_macros.ini
   [ ] C:\EdingCNC5.3\icons\op_f_key\user\U1.bmp
   [ ] C:\EdingCNC5.3\icons\op_f_key\user\U12.bmp
   [ ] C:\EdingCNC5.3\backups\  (Verzeichnis)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Version: 3.6.1
Datum: 2025-11-27
Fix: WMIC-AbhÃ¤ngigkeit entfernt + Backup-Pfad korrigiert
Kompatibel: Windows 7/8/10/11
